<!DOCTYPE html>
<html>
<head>
  <title>Custom loss functions for binary classification problems with highly imbalanced dataset   using Extreme Gradient Boosted Trees</title>

  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="chrome=1">
  <meta name="generator" content="pandoc" />



  <meta name="date" content="2019-09-28" />

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">

  <base target="_blank">

  <script type="text/javascript">
    var SLIDE_CONFIG = {
      // Slide settings
      settings: {
                title: 'Custom loss functions for binary classification problems with highly imbalanced dataset <br> using Extreme Gradient Boosted Trees',
                        useBuilds: true,
        usePrettify: true,
        enableSlideAreas: true,
        enableTouch: true,
                      },

      // Author information
      presenters: [
            {
        name:  'Bartosz Kolasa, Patryk Wielopolski' ,
        company: '',
        gplus: '',
        twitter: '',
        www: '',
        github: ''
      },
            ]
    };
  </script>

  <link href="WhyR_Presentation_2_files/ioslides-13.5.1/fonts/fonts.css" rel="stylesheet" />
  <link href="WhyR_Presentation_2_files/ioslides-13.5.1/theme/css/default.css" rel="stylesheet" />
  <link href="WhyR_Presentation_2_files/ioslides-13.5.1/theme/css/phone.css" rel="stylesheet" />
  <script src="WhyR_Presentation_2_files/ioslides-13.5.1/js/modernizr.custom.45394.js"></script>
  <script src="WhyR_Presentation_2_files/ioslides-13.5.1/js/prettify/prettify.js"></script>
  <script src="WhyR_Presentation_2_files/ioslides-13.5.1/js/prettify/lang-r.js"></script>
  <script src="WhyR_Presentation_2_files/ioslides-13.5.1/js/prettify/lang-yaml.js"></script>
  <script src="WhyR_Presentation_2_files/ioslides-13.5.1/js/hammer.js"></script>
  <script src="WhyR_Presentation_2_files/ioslides-13.5.1/js/slide-controller.js"></script>
  <script src="WhyR_Presentation_2_files/ioslides-13.5.1/js/slide-deck.js"></script>

  <style type="text/css">

    b, strong {
      font-weight: bold;
    }

    em {
      font-style: italic;
    }

    summary {
      display: list-item;
    }

    slides > slide {
      -webkit-transition: all 0.4s ease-in-out;
      -moz-transition: all 0.4s ease-in-out;
      -o-transition: all 0.4s ease-in-out;
      transition: all 0.4s ease-in-out;
    }

    .auto-fadein {
      -webkit-transition: opacity 0.6s ease-in;
      -webkit-transition-delay: 0.4s;
      -moz-transition: opacity 0.6s ease-in 0.4s;
      -o-transition: opacity 0.6s ease-in 0.4s;
      transition: opacity 0.6s ease-in 0.4s;
      opacity: 0;
    }
/* https://github.com/ropensci/plotly/pull/524#issuecomment-468142578 */
slide:not(.current) .plotly.html-widget{
  display: block;
}

  </style>

  <link rel="stylesheet" href="milligram.css" type="text/css" />

</head>

<body style="opacity: 0">

<slides class="layout-widescreen">

  <slide class="title-slide segue nobackground">
        <!-- The content of this hgroup is replaced programmatically through the slide_config.json. -->
    <hgroup class="auto-fadein">
      <h1 data-config-title><!-- populated from slide_config.json --></h1>
      <h2 data-config-subtitle><!-- populated from slide_config.json --></h2>
      <p data-config-presenter><!-- populated from slide_config.json --></p>
            <p style="margin-top: 6px; margin-left: -2px;">28 September 2019</p>
          </hgroup>
  </slide>

<slide class=""><hgroup><h2>About us</h2></hgroup><article  id="about-us">

<img src='image.png' title='fig:'/><p class='caption'>Photos of me and Bartek</p>

<p>Data Science Team at DataWalk</p>

</article></slide><slide class=""><hgroup><h2>Agenda</h2></hgroup><article  id="agenda">

<ol class = 'build'>
<li>Motivation and problem statement</li>
<li>Theoretical aspect</li>
<li>Experiment</li>
<li>Implementation challenges</li>
<li>Results and conclusions</li>
</ol>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Motivation and problem statement</h2></hgroup><article  id="motivation-and-problem-statement">

</article></slide><slide class=""><hgroup><h2>Motivation</h2></hgroup><article  id="motivation">

<ul class = 'build'>
<li>Assymetrical cost of mistakes both in classification and regression problems</li>
<li>Highly imbalanced dataset</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Problem statement</h2></hgroup><article  id="problem-statement">

<p>Dataset:</p>

<ul class = 'build'>
<li>Imbalanced dataset</li>
</ul>

<p>Problem:</p>

<ul class = 'build'>
<li>Classification problem = Cross entropy (symetric function)</li>
</ul>

<p>Tool:</p>

<ul class = 'build'>
<li>XGBoost with implementation of custom loss function</li>
</ul>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Theoretical aspect</h2></hgroup><article  id="theoretical-aspect">

</article></slide><slide class=""><hgroup><h2>Custom Loss Functions</h2></hgroup><article  id="custom-loss-functions" class="smaller">

<ul class = 'build'>
<li>Weighted Cross Entropy \[ L_{CE}=−Dylog(\hat{y})+(1−y)log(1−\hat{y}) \]</li>
<li>Focal Loss \[ FL = -y(1-\hat{y})^{\gamma}log(\hat{y}) - (1-y)\hat{y}^{\gamma}log(1-\hat{y}) \]</li>
<li>Bilinear Loss \[ L_{CE+B}=(1-\alpha)[−ylog(\hat{y})+(1−y)log(1−\hat{y})] + \alpha[yD + \hat{y} -y\hat{y}(1+D)]\]</li>
<li>Log Bilinear Loss (after transformations equal to Weigted Cross Entropy)</li>
</ul>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Experiment</h2></hgroup><article  id="experiment">

</article></slide><slide class=""><hgroup><h2>Experiment descriptions</h2></hgroup><article  id="experiment-descriptions">

<p>Dataset:</p>

<ul class = 'build'>
<li>Real-world dataset from Insurance Industry (PCA)</li>
</ul>

<p>Metric:</p>

<ul class = 'build'>
<li>AUCPR</li>
</ul>

<p>Experiment:</p>

<ul class = 'build'>
<li>Best AUCPR for all proposed custom loss functions</li>
</ul>

</article></slide><slide class="segue dark nobackground level1"><hgroup class = 'auto-fadein'><h2>Implementation challenges</h2></hgroup><article  id="implementation-challenges">

</article></slide><slide class=""><hgroup><h2>Implementation</h2></hgroup><article  id="implementation">

<p>For implementation we used widely known R packages:</p>

<ul class = 'build'>
<li>xgboost</li>
<li>dplyr</li>
<li>mlr</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Contribution</h2></hgroup><article  id="contribution">

<p>Our contributions:</p>

<ul class = 'build'>
<li>Providing essential derivatives for bilinear loss</li>
<li>Providing calculations about equality of log-bilinear loss and weighted cross entropy</li>
<li>Implementation of custom loss functions</li>
<li>Implementation of mlr wrapper for XGBoost with custom loss functions</li>
<li>Implementation of mlr wrapper for AUCPR measure</li>
</ul>

</article></slide><slide class=""><hgroup><h2>Results</h2></hgroup><article  id="results">

<p>To be announced.</p>

<table class = 'rmdtable'>
<tr class="header">
<th align="left">Loss.function</th>
<th align="right">Cross.Entropy</th>
<th align="right">Focal.loss</th>
<th align="right">Weighted.CE</th>
<th align="right">Bilinear</th>
</tr>
<tr class="odd">
<td align="left">AUCPR</td>
<td align="right">0.23</td>
<td align="right">0.023</td>
<td align="right">0.70</td>
<td align="right">0.10</td>
</tr>
<tr class="even">
<td align="left">AUCPR @ 0.75</td>
<td align="right">0.34</td>
<td align="right">0.100</td>
<td align="right">0.99</td>
<td align="right">0.23</td>
</tr>
</table>

</article></slide><slide class=""><hgroup><h2>Conclusions</h2></hgroup><article  id="conclusions">

<ul class = 'build'>
<li>Conclusion 1</li>
<li>Conclustion 2</li>
</ul>

</article></slide><slide class=""><hgroup><h2></h2></hgroup><article  id="section" class="flexbox vcenter">

<h3>Thanks for your attention!</h3>

<h3>Questions?</h3>

</article></slide><slide class=""><hgroup><h2>References</h2></hgroup><article  id="references" class="unnumbered">

<div id="refs" class="references">
<div id="ref-2017arXiv170802002L">
<p>Lin, Tsung-Yi, Priya Goyal, Ross Girshick, Kaiming He, and Piotr Dollár. n.d. “Focal Loss for Dense Object Detection.”</p></div>

<div id="ref-pmlr-v74-resheff17a">
<p>Resheff, Yehezkel S., Amit Mandelbom, and Daphna Weinshall. n.d. “Controlling Imbalanced Error in Deep Learning with the Log Bilinear Loss.” In.</p></div>

<div id="ref-2019arXiv190801672W">
<p>Wang, Chen, Chengyuan Deng, and Suzhen Wang. n.d. “Imbalance-XGBoost: Leveraging Weighted and Focal Losses for Binary Label-Imbalanced Classification with XGBoost.”</p></div></div></article></slide>


  <slide class="backdrop"></slide>

</slides>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

<!-- map slide visiblity events into shiny -->
<script>
  (function() {
    if (window.jQuery) {
       window.jQuery(document).on('slideleave', function(e) {
         window.jQuery(e.target).trigger('hidden');
      });
       window.jQuery(document).on('slideenter', function(e) {
         window.jQuery(e.target).trigger('shown');
      });
    }
  })();
</script>

</body>
</html>
